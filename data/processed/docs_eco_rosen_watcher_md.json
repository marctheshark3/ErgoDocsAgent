{
  "id": "docs_eco_rosen_watcher_md",
  "title": "Ergo Rosen Bridge Watcher Setup",
  "summary": "This document provides a guide for setting up the Ergo Rosen Bridge Watcher, which is an integral part of the Rosen Bridge as a cross-chain oracle. It covers the pre-requisites, setup guides for different platforms, frequently asked questions, and troubleshooting tips. The key points include the role and rewards of watchers, collateral and permit requirements, the reporting process, and security considerations. The document also addresses common issues like the scanner being out of sync and provides solutions.",
  "qa_pairs": [
    {
      "question": "What is the role and rewards of Watchers in the Rosen Bridge?",
      "answer": "Watchers are essential for accurate reporting and receive 70% of transaction fees as rewards for successful and accurate reporting, while 30% goes to the guard set. 25% of the emission is also reserved for 'Event-Based Emission (Rewards)'"
    },
    {
      "question": "Who can become a Watcher?",
      "answer": "Anyone can become a Watcher by configuring and running the Watcher app for their desired network, topping it off with enough RSN and ERG, putting in collateral, and receiving reporting permits to enjoy reporting and getting rewards."
    },
    {
      "question": "Is there a limit on the number of Watchers?",
      "answer": "77 is the one repo's capacity and cannot be changed, but more repos will be opened. A minimum of 60%+1 of the total number of Watchers is required to trigger an event, adjustable by the guard set."
    },
    {
      "question": "Can I run multiple Watchers?",
      "answer": "Yes, but it incurs financial considerations to prevent abuse. Each instance needs a unique folder and WATCHER_PORT."
    },
    {
      "question": "What are the pre-requisites for setting up a Watcher?",
      "answer": "See the pre-requisites page for information on setting up a local node, as well as minimal hardware and software requirements (Docker)."
    }
  ],
  "sections": [
    {
      "heading": "Introduction",
      "level": 0,
      "content": "---\ntags:\n  - Rosen Bridge\n  - Watcher\n  - Setup\n  - Guide\n  - FAQ\n  - Troubleshooting\n  - Cross-chain\n  - Oracle\n---"
    },
    {
      "heading": "Ergo Rosen Bridge Watcher Setup",
      "level": 1,
      "content": "Watchers are integral to Rosen Bridge, serving as cross-chain oracles. They observe and report deposit events on their network to Ergo, contributing to the network's security and expansion."
    },
    {
      "heading": "Watcher Setup Guides",
      "level": 2,
      "content": "//// details | Tutorials\n     {type: info, open: true}\n/// details | Pre-requisites\n     {type: danger, open: true}\nSee the [pre-requisites page](rosen-preq.md) for information on setting up a local node, as well as minimal hardware and software requirements. (Docker)\n///\nThere is a [General Watchers app Tutorials Playlist](https://youtube.com/playlist?list=PLyQeADPK2PWgztdc9lCvAyqjknPaN9woQ&si=SNYxoZMv2iID610o), and more tailored guides for each platform available:\n\n/// details | Windows\n     {type: info, open: false}\n- Follow along as QX guides you through a [Windows Watcher installation](https://www.youtube.com/watch?time_continue=2&v=bQ2sviHtOQA&embeds_referring_euri=https%3A%2F%2Fwww.therefour.org%2F&embeds_referring_origin=https%3A%2F%2Fwww.therefour.org&source_ve_path=Mjg2NjY&feature=emb_logo)\n- [Rosen Bridge Watcher \u2014 Windows Setup Guide](https://medium.com/@goatspark/rosen-bridge-watcher-windows-setup-guide-4040815e0a74)\n///\n/// details | Mac\n     {type: info, open: false}\n- [Rosen Watcher with Mac (ErgoTutorials)](https://ergotutorials.com/video/rosen-bridge)\n///\n/// details | Linux\n     {type: info, open: false}\nmgpai walks through a Watcher instance in [Linux and Cloud](https://www.youtube.com/watch?time_continue=1&v=1dpfLWdWMLs&embeds_referring_euri=https%3A%2F%2Fwww.therefour.org%2F&embeds_referring_origin=https%3A%2F%2Fwww.therefour.org&source_ve_path=MjM4NTE&feature=emb_title)\n///\n\n    \n\n\nBelow you'll find some frequently asked questions as well as common issues and troubleshooting tips.\n////"
    },
    {
      "heading": "Watcher FAQs",
      "level": 2,
      "content": ""
    },
    {
      "heading": "Operational",
      "level": 3,
      "content": "/// details | Role and Rewards\n     {type: question, open: false}\nWatchers are essential for accurate reporting and receive 70% of transaction fees as rewards for successful and accurate reporting. (while 30% goes to the guard set). 25% of the emission is also reserved for *'Event-Based Emission (Rewards)'*\n///\n\n/// details | Who can become a Watcher?\n     {type: question, open: false}\nAnyone. You can actively contribute to the expansion and security audit of the Rosen Bridge by becoming a Watcher. Watchers receive rewards for accurate reporting.\n\n- Configure and run the Watcher app for your desired network (In progress, so stay tuned!).\n- Top it off with enough RSN and ERG.\n- Put in collateral and receive reporting permits.\n- Enjoy reporting and getting rewards.\n///\n\n/// details | Is there a limit on the number of watchers?\n     {type: question, open: false}\n77 is the one repo's capacity and cannot be changed, but we'll open other repos. So technically, we can have any number of repos that each has 77 watchers. However, in long run I assume one or two repos is sufficient for each network.\n\nA minimum of 60%+1 of the total number of watchers is required to trigger an event, adjustable by the guard set.\n///\n\n/// details | Can I run multiple watchers?\n     {type: question, open: false}\nYes, but it incurs financial considerations to prevent abuse. Each instance needs a unique folder and WATCHER_PORT.\n///"
    },
    {
      "heading": "Collateral, Permits and Reporting",
      "level": 3,
      "content": "/// details | Collateral Requirements\n     {type: question, open: false}\nEach instance requires 800 ERG and 30,000 RSN as collateral. This collateral is fully redeemable and the amount is adjustable.\n///\n\n/// details | How do I redeem my collateral?\n     {type: question, open: false}\nYou can redeem it after redeeming your last permit token, but if you have unsettled reports, you must wait until those permits are returned.\n///\n\n/// details | Permit Acquisition\n     {type: question, open: false}\nTo report, watchers must acquire permits, costing an additional 3,000 RSN. Multiple permits are necessary for reporting concurrent events, and permits can be seized if reports are found fraudulent.\n///\n\n/// details | Reporting Process\n     {type: question, open: false}\n- Watchers report deposit events as part of a collective effort.\n- A consensus among watchers on an event triggers a final report and guard intervention.\n- Guards take necessary actions based on these reports.\n- Watchers involved in successful cross-chain settlements are rewarded.\n///\n\n/// details | What if my report is successful?\n     {type: question, open: false}\nYou'll receive rewards and your staked amount will be returned.\n///\n\n/// details | What if my report is incorrect and uncorroborated?\n     {type: question, open: false}\nYou'll get a refund of your stake without any additional penalties.\n///\n\n/// details | What are the consequences of collusion and fraud in reporting?\n     {type: question, open: false}\nColluding watchers will lose the amount they staked.\n///\n\n/// details | Are permits spent or staked for reporting?\n     {type: question, open: false}\nPermits are staked, not spent, and can be managed through your dashboard.\n///\n\n/// details | Can I adjust my permits?\n     {type: question, open: false}\nYes, you can increase or decrease your permits at any time and redeem them when leaving.\n///\n\n/// details | How many permits are needed for concurrent reporting?\n     {type: question, open: false}\nThe number depends on bridge activity, with about 160 needed to report one transaction per minute.\n///\n\n\n\n/// details | Do I still need RSN on Ergo to be a watcher on another chain?\n     {type: question, open: false}\nYes, all permit operations are conducted on the Ergo platform, and Rosen's logic is Ergo-based.\n///"
    },
    {
      "heading": "Operational",
      "level": 2,
      "content": "/// details | Do I need to do anything after setup?\n     {type: question, open: false}\nYou don't need to manually watch and approve transactions, the software will handle everything automatically, you just need to ensure the watcher keeps running.\n\n1. Observe an event and wait a bit.\n2. Create a commitment using report permits.\n3. Aggregate all participating watchers commitment (into something called event trigger).\n4. Wait for guards stuff, especially target chain tx and reward tx submission.\n5. Get rewards.\n///\n\n\n\n\n/// details | Interacting with a headless server\n     {type: info, open: false}\n\nTo interact with a headless server, you can use SSH (Secure Shell) to establish a secure connection. You can also forward ports to access specific services on the server. In the example below, we are using SSH to forward the local port 3030 to port 3030 on the server. This allows us to access a service running on port 3030 of the server as if it was running on our local machine.\n\n```bash\nssh -L 3030:127.0.0.1:3030 user@watcher-server\n```\n\nIn this command:\n\n- `ssh` is the command to start the SSH client program.\n- `-L 3030:127.0.0.1:3030` specifies that the local port 3030 should be forwarded to port 3030 on the server. `127.0.0.1` is the loopback IP address, which refers to the server itself in this context.\n- `user@watcher-server` specifies the username and the server to connect to. Replace `user` with your actual username and `watcher-server` with the actual hostname or IP address of your server.\n///\n\n/// details | Security Considerations\n{type: warning, open: false}\n\n- Keep your watcher machine and Docker installation updated with the latest security patches.\n- Do not reuse your watcher's RPC password anywhere else.\n- Secure your machine's SSH login with a strong password and/or public key authentication.\n- Consider running the watcher in a dedicated VM or container for isolation.\n- Regularly monitor your watcher's logs and web UI for any signs of issues.\n- Keep your collateral wallet secure, as the wallet owner has control over unstaking collateral.\n  ///\n\n/// details | Monitoring and Alerting\n{type: info, open: false}\nMaintaining high watcher uptime is critical to avoid collateral penalties. Consider setting up external monitoring and alerting:\n\n- Use services like Uptime Robot or Pingdom to monitor your watcher's web UI and alert you if it goes down.\n- Use a service like Healthchecks.io to monitor your watcher's log for error keywords and send alerts.\n- The Rosen team's monitoring will alert in Telegram/Discord if your watcher is down, but additional self-monitoring is strongly recommended.\n  ///\n\n/// details | Using a Config File for Environment Variables\n{type: info, open: false}\nInstead of specifying environment variables in the `docker-compose.yml` file, you can use a separate `.env` file. This keeps your compose file cleaner and allows for easier management of environment variables.\n\nCreate a `.env` file in the same directory as your `docker-compose.yml` with the following content:\n\n```shell\nCURRENT_NETWORK=BITCOIN\nDATABASE_URL=file:/app/services/watcher/data/database/data.sqlite\nHTTP_PORT=3030\nLOGGER_LEVEL=info\n```\n\nUpdate your `docker-compose.yml` to reference these variables:\n\n```yaml\nservices:\n  service:\n    image: rapidfort/postgresql:16.0.0\n    container_name: watcher_btc\n    env_file:\n      - .env\n    # ... rest of the service definition\n```\n\nDocker Compose will automatically load the variables from the `.env` file.\n///"
    },
    {
      "heading": "Troubleshooting",
      "level": 2,
      "content": ""
    },
    {
      "heading": "UI Errors",
      "level": 3,
      "content": "/// details | scanner is out of sync\n     {type: danger, open: false}\n\nYour scanner is out of sync. You need to wait until it scan all blocks. The service runs every 3 minutes or so. Depending on when it calls and blocks produced it may drop a block sync here and there but catches up in most cases.\n\nAlternatively you can delete docker volumes and restart your watcher with newer initial height\n\nThen it doesn't need to scan that much blocks to be synced\n\n```bash\ndocker compose down --volumes\n```\n\nThen update the `local.yaml` initial height\n\nThen rerun the watcher\n///\n\n/// details | Permit Health Broken\n     {type: danger, open: false}\n\nBy default, the permit health warning parameter is set to 100. This is adjustable locally by adding the following into your local.yaml and adjusting as neccessary\n\n\n```yaml\nhealthCheck:\n  permit:\n     warnCommitmentCount: 1 # amount of permits left before giving a warning\n     criticalCommitmentCount: 0 # amount of permits left it is critical\n```\n\nAdjust the numbers as you wish.\n\n`warnCommitmentCount` will change the warning to yellow when the available Permits reduce to the number.\n\n`criticalCommitmentCount` will change to red when the available Permits reduce to this number.\n///\n/// details | watcher-db-1 is unhealthy\n     {type: danger, open: false}\n> dependency failed to start: container watcher-db-1 is unhealthy\n\n- Your .env file might be missing? turn on view file extensions like in the video, are you sure it's .env and not .env.txt?\n- update your local.yaml with the current ergo blockheight\n\nAs a last resort, some ssers are reporting that this issue can be fixed by pruning existing images and rebuilding \n\n```\ndocker system prune -a\n``` \n\n**As long as you don't have other docker images to worry about.**\n\n///\n\n\n\n\n\n\n/// details | Lock, Unlock 500 Error\n     {type: danger, open: false}\n\nIf you're receiving a 500 Error while trying to lock or unlock your ERG and/or RSN, it could possibly be from having an insufficient box value on chain. **This is fixed in the latest release, please update if you have not done so already.**\n\nUpdate with \n```\ndocker-compose pull\ndocker-compose down\ndocker-compose up -d\n```\n\nplease check your service logs first. If you see a warning indicating \"Box value BoxValue(1100000) is too low, minimum value for box size of ...\"\n\nTo rectify, add the following to your local.yaml in the \"ergo:\" section with one tab indent. (should be the same indent as `initialHeight`).\n\n```yaml\n  minBoxValue: '2000000'\n```\n///\n\n/// details | UnhandeledPromiseRejection\n     {type: danger, open: false}\n> UnhandeledPromiseRejection, promise rejected with reason Object.....LifeCycle script start failed\n\nThere is a issue in ogmios roll backward after a fork. Fix is a work in progress.\n///\n\n/// details | The requested image's platform (linux/amd64) does not match the detected host platform\n     {type: danger, open: false}\nIncompatiblility with certain ARM chips in Rasberry Pi's and (ARM mac mini m1 Asahi linux: see [this PR](https://github.com/rosen-bridge/operation/issues/6))\n///"
    },
    {
      "heading": "Working with docker",
      "level": 3,
      "content": "/// details | Checking logs\n     {type: info, open: false}\n```bash\ndocker compose logs\n```\n\n///\n\n\n/// details | Updating your watcher\n     {type: info, open: false}\n```bash\ndocker-compose pull\ndocker-compose down\ndocker-compose up -d\n```\n///\n\n/// details | Restarting your watcher\n     {type: info, open: false}\nYou can restart your watcher instance simply by running the following command from within the same folder the `docker-compose.yaml` is stored.\n\n```bash\ndocker compose up -d\n```\n\n///\n\n/// details | no configuration files provided: not found\n     {type: danger, open: false}\n\nCheck you're in the correct directory. You should be executing `docker compose` commands from within the `operation/watcher` folder\n///\n\n/// details | Dumping databases\n     {type: info, open: false}\n```bash\ndocker compose down\ndocker volume remove watcher_postgres-data\n#---edit block height in YAML after this step\ndocker compose up -d\n```\n///\n\n/// details | Clearing Volumes\n     {type: info, open: false}\nYou may wish to clear Docker volumes for a number of reasons, e.g. changing Initial_Height to sync. To do so run the following Docker command from the Watcher directory\n\n```bash\ndocker compose down --volumes\n```\nRe-initiate the Watcher with\n```bash\ndocker compose up -d\n```\n///\n\n/// details | Clean Slate\n     {type: info, open: false}\nIf you want to remove everything and start from scratch\n\n```bash\ndocker ps -a\ndocker compose down\ndocker rm CONTAINERID1 CONTAINERID2 CONTAINERID3\n```\nthen delete the folder and start fresh\n///"
    }
  ],
  "source": "https://github.com/ergoplatform/ergodocs",
  "file_path": "docs/eco/rosen/watcher.md",
  "processed_at": "2025-05-11T19:47:37.051035",
  "ai_processed": true
}