# Docker Setup for ErgoDocsAgent

This document explains how to run ErgoDocsAgent using Docker and Docker Compose, which provides a consistent environment with Python 3.11 and all dependencies pre-installed.

## Prerequisites

- [Docker](https://docs.docker.com/get-docker/)
- [Docker Compose](https://docs.docker.com/compose/install/) (usually included with Docker Desktop)

## Quick Start

1. **Prepare your environment file**

   Copy the example environment file and edit it with your API keys:

   ```bash
   cp env.example .env
   ```

   Edit `.env` with your text editor and add your OpenAI API key.

2. **Build and run with Docker Compose**

   ```bash
   docker compose up
   ```

   This will build the Docker image (if not already built) and run the container.

3. **Run in the background**

   ```bash
   docker compose up -d
   ```

   The `-d` flag runs the container in detached mode (background).

## Run with Custom Options

You can pass custom command-line arguments to the application by editing the `docker-compose.yml` file or by running a one-off command:

```bash
# Process a specific source
docker compose run --rm ergo-docs-agent --source https://github.com/ergoplatform/ergodocs

# Run in scheduled mode
docker compose run --rm ergo-docs-agent --schedule

# Run immediately and exit
docker compose run --rm ergo-docs-agent --now
```

## Accessing Output Files

The output files are mapped from the container to your local `./output` directory, which means:

1. Files generated by the container will appear in your local `output` folder.
2. The files persist even after the container stops.

## Rebuilding the Container

If you make changes to the Dockerfile, requirements.txt, or need to rebuild the container:

```bash
docker compose build
```

## Common Docker Commands

- View running containers: `docker ps`
- View logs: `docker compose logs`
- Stop containers: `docker compose down`
- Remove containers and volumes: `docker compose down -v`

## Advanced Configuration

### Custom Configuration File

You can mount a custom configuration file by adding it to the `volumes` section in `docker-compose.yml`:

```yaml
volumes:
  - ./output:/app/output
  - ./.env:/app/.env:ro
  - ./custom-config.json:/app/config.json:ro
```

### Environment Variables

Environment variables can be set directly in the `docker-compose.yml` file:

```yaml
environment:
  - OPENAI_API_KEY=your_key_here
  - LOG_LEVEL=DEBUG
  - MAX_DOCUMENTS=200
```

However, it's generally safer to use the `.env` file approach to avoid committing sensitive information to version control. 