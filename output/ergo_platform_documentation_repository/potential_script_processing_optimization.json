{
  "title": "Potential Script Processing Optimization",
  "source_url": "docs/dev/scs/ergotree/script-optimisation.md",
  "summary": "# Potential Script Processing Optimization\n\nBefore an ErgoScript contract can be stored in a blockchain, it must be compiled from its source code into ErgoTree and then serialized into a byte array. The ErgoTree compiler, due to its purely functional graph-based IR, can perform various optimizations to reduce the tree's size. This results in normalization/unification, where different original scripts may compile into identical ErgoTrees and, consequently, identical serialized bytes. The obstacle to this optimization is the constants embedded in contracts. A\n\n simple solution to this problem is to avoid embedding constants.",
  "keywords": [
    "potential",
    "script",
    "processing",
    "optimization",
    "ergoscript",
    "contract",
    "blockchain",
    "source",
    "code",
    "ergotree",
    "byte",
    "array",
    "compiler",
    "graph",
    "tree",
    "size",
    "result",
    "normalization",
    "unification",
    "ergotrees",
    "obstacle",
    "constant",
    "solution",
    "problem",
    "body",
    "placeholder",
    "node",
    "index",
    "collection",
    "format",
    "expression",
    "eip5",
    "ergoplatform",
    "blob",
    "master",
    "eip-0005.md"
  ],
  "sections": [
    {
      "heading": "Potential Script Processing Optimization",
      "content": "Before an ErgoScript contract can be stored in a blockchain, it must be compiled from its source code into ErgoTree and then serialized into a byte array. The ErgoTree compiler, due to its purely functional graph-based IR, can perform various optimizations to reduce the tree's size. This results in normalization/unification, where different original scripts may compile into identical ErgoTrees and, consequently, identical serialized bytes.\nThe obstacle to this optimization is the constants embedded in contracts. A\nsimple solution to this problem is to avoid embedding constants. Each constant in the body of ErgoTree can be replaced with an indexed placeholder node. Each placeholder has an index of the constant in the constants collection of ErgoTree.\nThe format of serialized ErgoTree thus contains the bytes of a collection with segregated constants and the bytes of script expression with placeholders.\nEIP5 is based on this ErgoTree feature"
    }
  ],
  "qa_pairs": []
}